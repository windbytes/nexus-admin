# 数据库驱动维护模块

## 功能概述

数据库驱动维护模块用于动态管理系统中的数据库驱动程序（JDBC驱动），支持多种数据库类型的驱动上传、下载、编辑和删除操作。

## 主要功能

### 1. 驱动检索
- 支持按驱动名称、数据库类型、状态进行搜索
- 实时搜索和过滤功能
- 一键重置搜索条件

### 2. 驱动管理
- **新增驱动**：支持上传 JDBC 驱动文件（.jar格式）
- **编辑驱动**：修改驱动的基本信息和状态
- **删除驱动**：单个删除或批量删除
- **批量操作**：支持多选进行批量删除和批量下载

### 3. 文件上传
- **分片上传**：大文件自动分片上传（默认2MB/片）
- **断点续传**：网络中断后可从断点处继续上传
- **拖拽上传**：支持拖拽文件到上传区域
- **进度显示**：实时显示上传进度
- **大文件支持**：最大支持500MB的驱动文件

### 4. 驱动信息展示
表格展示以下信息：
- 驱动名称
- 数据库类型（MySQL、PostgreSQL、Oracle等）
- 驱动类（完整的Java类名）
- 驱动版本
- 文件名称
- 文件大小（自动格式化）
- 上传时间
- 状态（启用/禁用）
- 备注信息

### 5. 批量下载
- 支持单个驱动文件下载
- 支持批量下载（自动打包为ZIP）

## 技术特性

### 性能优化
1. **组件拆分**：将页面拆分为多个独立组件，实现最小化渲染
2. **memo优化**：使用 React.memo 避免不必要的重渲染
3. **useCallback**：缓存回调函数，减少子组件重渲染
4. **分页加载**：支持自定义每页数量（10/20/50/100）

### 数据管理
1. **React Query**：使用 @tanstack/react-query 管理服务端状态
2. **自动缓存**：查询结果自动缓存，减少网络请求
3. **乐观更新**：状态变更立即响应，提升用户体验

### 用户体验
1. **响应式布局**：适配不同屏幕尺寸
2. **操作提示**：所有操作都有明确的成功/失败提示
3. **确认对话框**：删除等危险操作需要二次确认
4. **加载状态**：网络请求时显示加载动画
5. **表格固定列**：关键列固定，方便浏览大量数据

## 组件结构

```
Database/
├── index.tsx                    # 主页面组件
├── components/
│   ├── DriverSearchForm.tsx    # 搜索表单组件
│   ├── DriverTableActions.tsx  # 表格操作按钮组件
│   ├── DriverTable.tsx         # 驱动表格组件
│   └── DriverModal.tsx         # 编辑/新增弹窗组件
└── README.md                    # 模块说明文档
```

## 支持的数据库类型

- MySQL
- PostgreSQL
- Oracle
- SQL Server
- DB2
- SQLite
- MariaDB
- 达梦（DM）
- 人大金仓（KingBase）
- 南大通用（GBase）
- 其他

## API 接口

```typescript
// 驱动服务接口
driverService.getDriverList()      // 获取驱动列表
driverService.addDriver()          // 新增驱动
driverService.updateDriver()       // 更新驱动
driverService.deleteDriver()       // 删除驱动
driverService.batchDeleteDriver()  // 批量删除驱动
driverService.downloadDriver()     // 下载驱动
driverService.batchDownloadDriver() // 批量下载驱动
driverService.uploadChunk()        // 上传文件分片
driverService.checkChunk()         // 检查分片是否已上传
driverService.mergeChunks()        // 合并文件分片
```

## 使用说明

### 新增驱动
1. 点击"新增"按钮
2. 填写驱动名称、数据库类型、驱动类等信息
3. 拖拽或点击上传 JDBC 驱动文件（.jar）
4. 等待文件上传完成（大文件会自动分片上传）
5. 点击"确定"保存

### 编辑驱动
1. 点击表格中的"编辑"按钮
2. 修改驱动信息
3. 可选择重新上传驱动文件
4. 点击"确定"保存

### 删除驱动
1. 单个删除：点击表格中的"删除"按钮
2. 批量删除：选中多个驱动后，点击"批量删除"按钮
3. 确认删除操作

### 下载驱动
1. 单个下载：点击表格中的"下载"按钮
2. 批量下载：选中多个驱动后，点击"批量下载"按钮（自动打包为ZIP）

### 状态管理
- 点击表格中的状态开关可直接启用/禁用驱动
- 禁用的驱动不会被系统使用

## 注意事项

1. **文件格式**：仅支持 .jar 格式的 JDBC 驱动文件
2. **文件大小**：单个文件最大支持 500MB
3. **驱动类名**：必须填写完整的 Java 类名，如 `com.mysql.cj.jdbc.Driver`
4. **断点续传**：上传过程中如果网络中断，重新上传会自动从断点处继续
5. **删除操作**：删除操作不可恢复，请谨慎操作

## 样式规范

- 使用 Tailwind CSS 进行样式编写
- 与系统整体风格保持一致
- 响应式设计，适配移动端和桌面端
- 遵循 Ant Design 设计规范

## 依赖项

- React 19
- Ant Design 5.x
- @tanstack/react-query
- crypto-js（用于文件哈希计算）
- axios（HTTP请求）

